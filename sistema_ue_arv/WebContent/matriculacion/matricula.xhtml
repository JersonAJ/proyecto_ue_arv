<ui:composition template="/layout/layout.xhtml"
xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
xmlns:h="http://xmlns.jcp.org/jsf/html"
xmlns:p="http://primefaces.org/ui"
xmlns:f="http://xmlns.jcp.org/jsf/core"
xmlns:pe="http://primefaces.org/ui/extensions">
			
	<ui:define name="titulo"><i class="fa fa-address-card" /> Matriculación / Matrículas</ui:define>
	
	<ui:define name="content">
		<h:form id="form" style="width: 100%">
			<f:metadata>		    
			    <f:viewAction action="#{general.validaSesion}" />
			</f:metadata>
				
			<p:growl id="growl" for="growl" showDetail="true" closable="true" />
			
			<p:outputPanel style="background-color: white; padding: 5px;">
				<p:commandLink update=":form:pnl" oncomplete="PF('dgl').show();">
					<i class="fa fa-plus-circle" />
					<span>Agregar</span>				
					
					<f:setPropertyActionListener value="true" target="#{matricula.ckEstado}" />
					<f:setPropertyActionListener value="0" target="#{matricula.accion}" />	
															
				</p:commandLink>					
			</p:outputPanel> 
			
			<!-- CONSULTA -->	
			<style>				
				.ui-datatable thead th, .ui-datatable tbody td, .ui-datatable tfoot td, .ui-datatable tfoot th { padding: 2px 10px; }
			</style>
			<br/>		
			<p:outputPanel>
			   <p:inputText style="width: 500px" value="#{matricula.itBuscar}" placeholder="Buscar por apellidos">
				<p:ajax event="keyup" update="dt" listener="#{matricula.buscar}"/>
			     	</p:inputText>	
				<p:spacer width="10px" />
			
				<div style="display: inline-flex">
					<h:selectBooleanCheckbox value="#{matricula.ckMostrarIC}">
	    				<p:ajax update="dt" listener="#{matricula.buscar}" />
	 				</h:selectBooleanCheckbox> 
		 			<h:outputLabel value="Mostrar inactivos" style="font-size: 12px; font-weight: normal; color: black; margin-top: 4px;" />			 				
		 		</div>	 			     			         			     			      				      		      			
			</p:outputPanel>
			 				 	
			<p:separator />
			  
			<pe:sheet id="sheet" widgetVar="sheetWidget" value="#{matricula.matriculaList}" var="row"   
			    height="400" rowKey="#{row.idMatricula}" fixedCols="2" fixedRows="3" showRowHeaders="true"  
			    resizableCols="true" resizableRows="true" filteredValue="#{matricula.filtroMatricula}"  
			    sortBy="#{row.idMatricula}" sortOrder="ascending" readOnly="false">  
			  
			    <p:ajax event="change" listener="#{sheetController.cellChangeEvent}" />  
			  
			    <f:facet name="header">  
			        <h:outputText value="Matrículas" />  
			    </f:facet>  
			  
			    <f:facet name="footer">  
			        <h:outputText id="footer" value="#{matricula.matriculaList.size()} Registros" />  
			    </f:facet>  
			  
			    <pe:sheetcolumn headerText="Id (read-only)" readonly="true" value="#{row.idMatricula}" 
			    				sortBy="#{row.idMatricula}" colWidth="150" filterBy="#{row.idMatricula}" />  
			    
			    <pe:sheetcolumn headerText="Arch" value="#{row.platformArch}" readonly="true"   
			                    colWidth="100" sortBy="#{row.platformArch}"   
			                    filterBy="#{row.platformArch}" />
			                    
			    <pe:sheetcolumn headerText="Type" value="#{row.matOferta.descripcion}" colWidth="200"   
			                    sortBy="#{row.matOferta.descripcion}" filterBy="#{row.matOferta.descripcion}"   
			                    filterOptions="#{row.matOferta.descripcion}"  
			                    colType="dropdown"   
			                    selectItems="#{AssetType.ALL_VALUES}" /> 
			                    
			    
			    <pe:sheetcolumn headerText="Aprobada" value="#{row.snAprobado eq 'S'? true:false}" colWidth="60" colType="checkbox"/>  
			    
			    <pe:sheetcolumn headerText="Activo" value="#{row.estado eq 'AC'? true:false}" colWidth="60" colType="checkbox"/>  
			    
			</pe:sheet>  
			
			<br/>
			<p:outputPanel style="background-color: white; padding: 5px; text-align: end">
				<h:commandLink value="Exportar a excel" style="color: green">                
	                <p:dataExporter type="xlsx" target="dt" fileName="matriculas" />
	            </h:commandLink>		   
            </p:outputPanel>
						
	   	</h:form>
	</ui:define>		
	
</ui:composition>
